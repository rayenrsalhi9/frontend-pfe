<div class="main-wrapper">
  <div class="content-container">
    <!-- Latest News Section -->
    <section class="news-section">
      <div class="section-header">
        <h3 class="section-title">{{ "DASHBOARD.NEWS" | translate }}</h3>
      </div>

      <div
        *ngIf="articles && articles.length > 0; else noNews"
        class="news-grid"
      >
        <div
          *ngFor="let article of articles"
          class="news-card"
          (click)="viewArticle(article)"
        >
          <div class="news-card-image">
            <img
              [src]="
                article.picture
                  ? getHost() + article.picture
                  : '/assets/images/others/bg-4.jpg'
              "
              alt=""
            />
            <span class="news-badge">{{ article.category.name }}</span>
          </div>
          <div class="news-card-content">
            <div class="news-meta">
              {{ article.createdAt | utcToLocalTime: "shortDate" }}
            </div>
            <h4 class="news-title">{{ article.title }}</h4>
            <p class="news-preview">{{ article.shortText }}</p>
          </div>
        </div>
      </div>
      <ng-template #noNews>
        <div class="muted-placeholder">
          <p>No news available at the moment.</p>
        </div>
      </ng-template>
    </section>

    <!-- Main Content Grid (Forum & Survey) -->
    <div class="main-grid">
      <!-- Left: Latest Forum -->
      <div class="forum-column">
        <div
          class="section-header d-flex justify-content-between align-items-center"
        >
          <h3 class="section-title">
            {{ "WELCOME.LATEST_FORUM" | translate }}
          </h3>
        </div>

        <div
          *ngIf="latestForums && latestForums.length > 0; else noForums"
          class="forum-list"
        >
          <div
            *ngFor="let forum of latestForums"
            class="forum-card"
            [routerLink]="'/forum/' + forum.id"
          >
            <div class="forum-card-body">
              <span class="category-badge">{{ forum.category.name }}</span>
              <h4 class="forum-item-title">{{ forum.title }}</h4>
              <div class="forum-item-meta">
                <span
                  >By {{ forum.creator.firstName }}
                  {{ forum.creator.lastName }}</span
                >
                <span class="meta-dot"></span>
                <span>{{ forum.createdAt | utcToLocalTime: "shortDate" }}</span>
              </div>
            </div>
          </div>
          <div class="view-all-wrapper">
            <a routerLink="/forum" class="view-all-link"
              >View all discussions â†’</a
            >
          </div>
        </div>
        <ng-template #noForums>
          <div class="muted-placeholder">
            <p>No forum discussions yet.</p>
          </div>
        </ng-template>
      </div>

      <!-- Right: Survey -->
      <div class="survey-column">
        <div *ngIf="survey" class="survey-card">
          <div class="survey-header">
            <h3 class="section-title">{{ "WELCOME.SURVEY" | translate }}</h3>
          </div>
          <div class="survey-body">
            <p class="survey-question">{{ survey.title }}</p>

            <div class="survey-actions">
              <ng-container *ngIf="survey.type == 'simple'">
                <button (click)="surveyAnswer(1)" class="btn-survey btn-yes">
                  {{ "BUTONS.YES" | translate }}
                </button>
                <button (click)="surveyAnswer(0)" class="btn-survey btn-no">
                  {{ "BUTONS.NO" | translate }}
                </button>
              </ng-container>

              <ng-container *ngIf="survey.type == 'rating'">
                <div class="rating-wrapper">
                  <rating
                    (click)="surveyAnswer($event.target.getAttribute('title'))"
                    [max]="5"
                    [readonly]="isReadonly"
                  ></rating>
                </div>
              </ng-container>

              <ng-container *ngIf="survey.type == 'satisfaction'">
                <button (click)="surveyAnswer(0)" class="btn-survey btn-yes">
                  {{ "BUTONS.SATISFIED" | translate }}
                </button>
                <button
                  (click)="surveyAnswer(1)"
                  class="btn-survey btn-neutral"
                >
                  {{ "BUTONS.NEUTRAL" | translate }}
                </button>
                <button (click)="surveyAnswer(2)" class="btn-survey btn-no">
                  {{ "BUTONS.NOT_SATISFIED" | translate }}
                </button>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
