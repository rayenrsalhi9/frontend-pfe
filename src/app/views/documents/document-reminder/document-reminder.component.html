<div class="card">
  <div class="card-header">
    <h4>{{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_TITLE' | translate}}</h4>
  </div>
  <div class="card-body">
    <form [formGroup]="reminderForm">
      <div mat-dialog-content>
        <div class="row">
          <div class="col-sm-12">
            <div class="row">
              <div class="col-md-12">
                <label class="form-label" for="subject"> {{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_SUBJECT' | translate}}</label>
                <input formControlName="subject" type="text" class="form-control" id="subject">
                <div class="text-danger"
                  *ngIf="reminderForm.get('subject').touched && reminderForm.get('subject')?.hasError('required')">
                  {{'DOCUMENTS.REMINDER.ERROR.SUBJECT_IS_REQUIRED' | translate}}
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-12">
                <label class="form-label" for="message">{{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_MESSAGE' | translate}}</label>
                <textarea class="form-control" formControlName="message" id="message" cols="30"></textarea>
                <div class="text-danger"
                  *ngIf="reminderForm.get('message').touched && reminderForm.get('message').hasError('required')">
                  {{'DOCUMENTS.REMINDER.ERROR.MESSAGE_IS_REQUIRED' | translate}}
                </div>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-6">
                <div class="form-check">
                  <input type="checkbox" class="form-check-input" id="repeatreminder" (change)="checkData($event)" formControlName="isRepeated">
                  <label style="margin-left: 5px;" for="repeatreminder"> {{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_REPEAT' | translate}}</label>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-check">
                  <input type="checkbox" class="form-check-input" id="sendemail" formControlName="isEmailNotification">
                  <label style="margin-left: 5px;" for="sendemail"> {{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_SEND_EMAIL' | translate}}</label>
                </div>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-12">
                <label class="form-label" for="message">{{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_USERS' | translate}}</label>
                <ng-select (change)="onSelectChange($event)" [multiple]="true">
                  <ng-option *ngFor="let user of users" [value]="user">{{user.firstName}} {{user.lastName}}</ng-option>
                </ng-select>
              </div>
            </div>
            <div class="row" *ngIf="reminderForm.get('isRepeated').value">
              <div class="col-md-6">
                <label class="form-label" for="frequency"> {{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_FREQUENCY' | translate}}</label>
                <select class="form-select" (change)="onFrequencyChange()" formControlName="frequency" id="frequency">
                  <option value="">--None--</option>
                  <option [value]="frequencyItem?.id" *ngFor="let frequencyItem of reminderFrequencies">
                    {{frequencyItem?.name | translate}}
                  </option>
                </select>
                <div class="text-danger" *ngIf="reminderForm.get('frequency').hasError('required')">
                  {{'DOCUMENTS.REMINDER.ERROR.FREQUENCY_IS_REQUIRED' | translate}}
                </div>
              </div>
            </div>
            <div class="row" *ngIf="reminderForm.get('isRepeated').value">
              <div class="col-md-12 m-t-10">
                <div *ngIf="reminderForm.get('frequency').value === '0'">
                  <label class="form-label" for="weekDays">{{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_WEEKDAYS' | translate}}</label>
                  <div id="weekDays" class="row">
                    <div class="col-sm-auto mr-1" formArrayName="dailyReminders" *ngFor="let dailyReminder of dailyRemindersArray.controls; let i=index">
                      <ng-container [formGroupName]="i">
                        <!-- <checkbox color="primary" class="mr-1" name="isActive" [value]="i" formControlName="isActive"> {{dailyReminder.get('name').value}} </checkbox> -->
                        <div class="form-check">
                          <input type="checkbox" class="form-check-input" [id]="i+'wof'" formControlName="isActive" [value]="i">
                          <label style="margin-left: 5px;" class="form-check-label" [for]="i+'wof'">{{dailyReminder.get('name').value | translate}}</label>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </div>
                <div *ngIf="reminderForm.get('frequency').value === '1'">
                  <label class="form-label" for="weekDay">{{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_WEEKDAYS' | translate}}</label>
                  <div id="weekDay">
                    <ng-container *ngFor="let day of dayOfWeek; let i=index">
                      <div class="form-check">
                        <input type="radio" class="form-check-input" name="dayOfWeek" [id]="i+'dof'" formControlName="dayOfWeek" [value]="day.id"> {{day.name | translate}}
                        <label style="margin-left: 5px;" class="form-check-label" [for]="i+'dof'"></label>
                      </div>
                    </ng-container>

                    <!-- <mat-radio-group formControlName="dayOfWeek">
                      <radio class="mr-2" color="primary" formControlName="dayOfWeek" name="dayOfWeek" [value]="day.id"
                        *ngFor="let day of dayOfWeek; let i=index">{{day.name}}</radio>
                    </mat-radio-group> -->
                  </div>
                </div>
                <div *ngIf="reminderForm.get('frequency').value === '3'">
                  <label class="form-label" for="Quarterly">{{'DOCUMENTS.REMINDER.LABEL.SELECT_QUARTER_DATE' | translate}}</label>
                  <div id="Quarterly" class="row">
                    <table class="table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>{{'DOCUMENTS.REMINDER.LABEL.SELECT_REMINDER_MONTH' | translate}}</th>
                          <th>{{'DOCUMENTS.REMINDER.LABEL.SELECT_REMINDER_DAY' | translate}}</th>
                        </tr>
                      </thead>
                      <tbody formArrayName="quarterlyReminders">
                        <tr *ngFor="let quarterlyReminder of quarterlyRemindersArray.controls; let i=index">
                          <ng-container [formGroupName]="i">
                            <td>{{quarterlyReminder.get('name').value | translate}}</td>
                            <td>
                              <select (change)="onDateChange(quarterlyReminder)" class="form-select"
                                formControlName="month">
                                <option [value]="mon.id" *ngFor="let mon of quarterlyReminder.get('monthValues').value">
                                  {{mon.name | translate}}
                                </option>
                              </select>
                            </td>
                            <td>
                              <select (change)="onDateChange(quarterlyReminder)" class="form-select"
                                formControlName="day">
                                <option [value]="day" *ngFor="let day of days">
                                  {{day | translate}}
                                </option>
                              </select>
                              <div
                                *ngIf="quarterlyReminder.get('day').touched && quarterlyReminder.hasError('invalidDate')">
                                <div class="text-danger">
                                  {{'DOCUMENTS.REMINDER.ERROR.PLEASE_SELECT_VALID_DAY' | translate}}
                                </div>
                              </div>
                            </td>
                          </ng-container>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <div *ngIf="reminderForm.get('frequency').value === '4'">
                  <label for="HalfYearly">{{'DOCUMENTS.REMINDER.LABEL.SELECT_DATE' | translate}}</label>
                  <div id="HalfYearly" class="row">
                    <table class="table">
                      <thead>
                        <tr>
                          <th></th>
                          <th>{{'DOCUMENTS.REMINDER.LABEL.SELECT_REMINDER_MONTH' | translate}}</th>
                          <th>{{'DOCUMENTS.REMINDER.LABEL.SELECT_REMINDER_DAY' | translate}}</th>
                        </tr>
                      </thead>
                      <tbody formArrayName="halfYearlyReminders">
                        <tr *ngFor="let halfYearlyReminder of halfYearlyRemindersArray.controls; let i=index">
                          <ng-container [formGroupName]="i">
                            <td>{{halfYearlyReminder.get('name').value | translate}}</td>
                            <td>
                              <select (change)="onDateChange(halfYearlyReminder)" class="form-select"
                                formControlName="month">
                                <option [value]="mon.id"
                                  *ngFor="let mon of halfYearlyReminder.get('monthValues').value">
                                  {{mon.name | translate}}
                                </option>
                              </select>
                            </td>
                            <td>
                              <select (change)="onDateChange(halfYearlyReminder)" class="form-select"
                                formControlName="day">
                                <option [value]="day" *ngFor="let day of days">
                                  {{day | translate}}
                                </option>
                              </select>
                              <div
                                *ngIf="halfYearlyReminder.get('day').touched && halfYearlyReminder.hasError('invalidDate')">
                                <div class="text-danger">
                                  {{'DOCUMENTS.REMINDER.ERROR.PLEASE_SELECT_VALID_DAY' | translate}}
                                </div>
                              </div>
                            </td>
                          </ng-container>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-4" *ngIf="!reminderForm.get('isRepeated').value">
                <label class="form-label" for="frequency"> {{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_DATE' | translate}}</label>
                <input class="form-control" bsDatepicker [bsConfig]="{ dateInputFormat: 'DD-MM-YYYY' }" [min]="minDate" formControlName="startDate"  placeholder="Date">
                <timepicker></timepicker>
                <div class="text-danger"
                  *ngIf="reminderForm.get('startDate').touched && reminderForm.get('startDate').errors?.['required']">
                  {{'DOCUMENTS.REMINDER.ERROR.DATE_IS_REQUIRED' | translate}}
                </div>
                <div class="text-danger"
                  *ngIf="reminderForm.get('startDate').touched && reminderForm.get('startDate').hasError('owlDateTimeMin')">
                  {{'DOCUMENTS.REMINDER.ERROR.START_DATE_SHOULD_BE_GREATER_THEN_CURRENT_DATE_TIME' | translate}}
                </div>
                <owl-date-time #dt2></owl-date-time>
              </div>
              <div class="col-md-6" *ngIf="reminderForm.get('isRepeated').value">
                <label class="form-label" for="frequency">{{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_START_DATE' | trandslate }}</label>
                <input class="form-control" bsDatepicker [bsConfig]="{ dateInputFormat: 'DD-MM-YYYY' }" [min]="minDate" formControlName="startDate"
                  placeholder="Start Date">
                <div class="text-danger"
                  *ngIf="reminderForm.get('startDate').touched && reminderForm.get('startDate').hasError('required')">
                  {{'DOCUMENTS.REMINDER.ERROR.START_DATE_IS_REQUIRED' | translate}}
                </div>
                <div class="text-danger"
                  *ngIf="reminderForm.get('startDate').touched  && reminderForm.get('startDate').hasError('owlDateTimeMin')">
                  {{'DOCUMENTS.REMINDER.ERROR.START_DATE_SHOULD_BE_GREATER_THEN_CURRENT_DATE_TIME' | translate}}
                </div>
                <owl-date-time #dt3></owl-date-time>
              </div>
              <div class="col-md-6" *ngIf="reminderForm.get('isRepeated').value">
                <label class="form-label" for="frequency">{{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_END_DATE' | translate }}</label>
                <input class="form-control" bsDatepicker [bsConfig]="{ dateInputFormat: 'DD-MM-YYYY' }" formControlName="endDate"
                  placeholder="{{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_END_DATE' | translate }}">
                <owl-date-time #dt4></owl-date-time>
              </div>
            </div>
          </div>
        </div>
        <div class="mt-2">
          <button style="margin-right: 10px;" (click)="createReminder()" type="submit"
            class="btn btn-success btn-sm m-r-10"><i class="fas fa-save"></i>
            {{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_SAVE' | translate }}
          </button>
          <button type="button" class="btn btn-danger btn-sm m-r-10" (click)="onCancel()"><i
              class="fas fa-times-circle"></i>
            {{'DOCUMENTS.REMINDER.LABEL.DOCUMENT_REMINDER_CANCEL' | translate }}
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
